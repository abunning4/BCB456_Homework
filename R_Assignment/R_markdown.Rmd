---
title: "R_Homework"
author: Angela Bunning
date: 2.23.17
output: html_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load in data to my project: 
`fang_et_al_genotypes.txt`:
```{r}
genotype_data_raw <- read.table(file = "fang_et_al_genotypes.txt", as.is = TRUE, header = TRUE)
```

`snp_position.txt`:
```{r}
snp_position_data_raw <- read.delim(file = "snp_position.txt", as.is = TRUE)
```

#Data Inspection:

`fang_et_al_genotypes.txt`:  

File size: 10.5 MB

Structure:
```{r}
str(genotype_data_raw)
```

* It is a data frame with 2783 observations and 986 variables total


Number of columns and rows:
```{r}
ncol(genotype_data_raw)      #986 columns
nrow(genotype_data_raw)      #2783 rows
```

Names of each variable:
```{r}
names_genotype <- names(genotype_data_raw)
names_genotype
```

Summary:
```{r}
genotype_summary <- summary(genotype_data_raw)
genotype_summary
```

`snp_position.txt`

File size: 80.8 KB

Structure: 
```{r}
str(snp_position_data_raw)
```

* data frame with 983 observations of 15 variables 

Number of rows and columns: 
```{r}
rows_snp_data <- nrow(snp_position_data_raw) # 983 rows
columns_snp_data <- ncol(snp_position_data_raw) # 15 columns 
```

Names of each variable:
```{r}
names_snps <- names(snp_position_data_raw)
names_snps
```

Summary:
```{r}
snp_summary <- summary(snp_position_data_raw)
snp_summary
```

# Data Proccessing 

* First, separate out the groups of interest we want for maize (ZMMIL, ZMMLR, and ZMMMR) and teosinte (ZMPBA, ZMPIL, and ZMPJA) from `fang_et_al_genotypes.txt`:

```{r}
library(dplyr)
```

For maize:
```{r}
genotypes_by_groups_maize <- filter(genotype_data_raw, Group == "ZMMIL" | Group == "ZMMLR" | Group == "ZMMMR")
genotypes_by_groups_maize
```

For teosinte: 
```{r}
genotypes_by_groups_teosinte <- filter(genotype_data_raw, Group == "ZMPBA" | Group == "ZMPIL" | Group == "ZMPJA")
genotypes_by_groups_teosinte
```


* Transpose data for both maize and teosinte:

maize:
```{r}
genotypes_maize_transposed <- t(genotypes_by_groups_maize)
genotypes_maize_transposed
```

teosinte:
```{r}
genotypes_teosinte_transposed <- t(genotypes_by_groups_teosinte)
genotypes_teosinte_transposed
```

* Only need certain columns from the `snp_position.txt` file for the analysis so we can cut those out by using the `select` function in dplyr:
```{r}
snp_columns_needed <- select(snp_position_data_raw, SNP_ID, Chromosome, Position)
snp_columns_needed
```


* Rename row names in `snp_position.txt`:
```{r}
rownames(snp_columns_needed) <- snp_columns_needed$SNP_ID
```

* Now we need to join the `snp_position.txt` with each of the maize group transposed and teosinte group transposed data files:

maize:
```{r}
joined_maize_genotypes_snp <- merge(snp_columns_needed, genotypes_maize_transposed, by ="row.names")
```

teosinte: 
```{r}
joined_teosinte_genotypes_snp <- merge(snp_columns_needed, genotypes_teosinte_transposed, by = "row.names")
```

